<div class="pull-left">
    <h2><a routerLink="">SmallURL</a></h2>
</div>

<div class="pull-right" [ngStyle]="{'margin-right':'1em', 'margin-top':'1em'}">
    <button mat-fab extended [matMenuTriggerFor]="menu">
        <mat-icon matTooltipClass="example-tooltip-uppercase" matTooltip='User Account'>account_circle</mat-icon>
    </button>
    <mat-menu #menu="matMenu">
        <button mat-menu-item routerLink="">
          <mat-icon>home</mat-icon>
          <span>Home</span>
        </button>
        <button mat-menu-item>
          <mat-icon>input</mat-icon>
          <span>Logout</span>
        </button>
      </mat-menu>
</div>


<div *ngIf="!loggedIn" [ngStyle]="{'padding-top':'10em', 'padding-left':'10em'}">
  <form (submit)="$event.preventDefault()">
    <input matInput cdkTextareaAutosize 
           name="url" [(ngModel)]="smallUrl" 
           placeholder="Enter your URL and hit Get!" 
           cdkAutosizeMinRows="1" cdkAutosizeMaxRows="10"/>
    <button (click)="getUrlDetailsSimple()" mat-fab extended>
      <mat-icon matTooltipClass="example-tooltip-uppercase" matTooltip='Get!'>motorcycle</mat-icon>
    </button>
  </form>
  <div *ngIf="urlData" [ngStyle]="{'padding-top':'2em'}">
    <cdk-accordion class="example-accordion">
      <cdk-accordion-item
      #accordionItem="cdkAccordionItem"
      class="example-accordion-item"
      role="button"
      tabindex="0"
      [attr.id]="accordion-header-0"
      [attr.aria-expanded]="accordionItem.expanded"
      [attr.aria-controls]="accordion-body-0">
      <div class="example-accordion-item-header" (click)="accordionItem.toggle()">
        <h4>URL Details
          <span class="example-accordion-item-description pull-right">
          Click to {{ accordionItem.expanded ? 'close' : 'open' }}
          </span>
        </h4><br/>
        <span [ngStyle]="{'font-weight':'bold'}">Short Code: </span> {{this.urlData.shortCode}} <br/>
        <span [ngStyle]="{'font-weight':'bold'}">Small URL Expired: </span> {{this.urlData.isExpired}} <br/>
        <span [ngStyle]="{'font-weight':'bold'}">Total Clicks: </span> {{this.urlData.totalClicks}} <br/>
        <span [ngStyle]="{'font-weight':'bold'}">Created On: </span> {{this.urlData.createdAt}}
      </div>
        <div class="example-accordion-item-body"
        role="region"
        [style.display]="accordionItem.expanded ? '' : 'none'"
        [attr.id]="accordion-body-0"
        [attr.aria-labelledby]="accordion-header-0">
          <table mat-table [dataSource]="this.urlData.clicksPerday">
            <!--Position Column-->
            <ng-container matColumnDef="position">
              <th mat-header-cell *matHeaderCellDef>No.</th>
              <td mat-cell *matCellDef="let index=index">{{index+1}}</td>
          </ng-container>

           <!--Date Column-->
           <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">{{element.date}}</td>
          </ng-container>

          <!--Count Column-->
          <ng-container matColumnDef="count">
            <th mat-header-cell *matHeaderCellDef>Count</th>
            <td mat-cell *matCellDef="let element">{{element.count}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="urlDataColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: urlDataColumns;"></tr>
          </table>
        </div>
      </cdk-accordion-item>
    </cdk-accordion>
  </div>
</div>

<div *ngIf="loggedIn" [ngStyle]="{'padding-top':'10em', 'padding-left':'10em'}">
  <h4>Hey {{name}}!</h4>
  <form (submit)="$event.preventDefault()">
    <input matInput cdkTextareaAutosize 
           name="url" [(ngModel)]="smallUrl" 
           placeholder="Enter your URL and hit Get!" 
           cdkAutosizeMinRows="1" cdkAutosizeMaxRows="10"/>
    <button (click)="getUrlDetails()" mat-fab extended>
      <mat-icon matTooltipClass="example-tooltip-uppercase" matTooltip='Get!'>motorcycle</mat-icon>
    </button>
  </form>
  <div *ngIf="userURLData" [ngStyle]="{'padding-top':'2em'}">
    <cdk-accordion class="example-accordion-detailed">
      <cdk-accordion-item
      #accordionItem="cdkAccordionItem"
      class="example-accordion-item"
      role="button"
      tabindex="0"
      [attr.id]="accordion-header-0"
      [attr.aria-expanded]="accordionItem.expanded"
      [attr.aria-controls]="accordion-body-0">
      <div class="example-accordion-item-header" (click)="accordionItem.toggle()">
        <h4>URL Details
          <span class="example-accordion-item-description pull-right">
          Click to {{ accordionItem.expanded ? 'close' : 'open' }}
          </span>
        </h4><br/>
        <span [ngStyle]="{'font-weight':'bold'}">Short Code: </span> {{this.userURLData.shortCode}} <br/>
        <span [ngStyle]="{'font-weight':'bold'}">Small URL Expired: </span> {{this.userURLData.isExpired}} <br/>
        <span [ngStyle]="{'font-weight':'bold'}">Total Sessions: </span> {{this.userURLData.sessions.length}} <br/>
        <span [ngStyle]="{'font-weight':'bold'}">Created On: </span> {{this.userURLData.createdAt}}
      </div>
        <div class="example-accordion-item-body"
        role="region"
        [style.display]="accordionItem.expanded ? '' : 'none'"
        [attr.id]="accordion-body-0"
        [attr.aria-labelledby]="accordion-header-0">
          <table mat-table [dataSource]="this.userURLData.sessions">
            <!--Position Column-->
            <ng-container matColumnDef="position">
              <th mat-header-cell *matHeaderCellDef>No.</th>
              <td mat-cell *matCellDef="let index=index">{{index+1}}</td>
          </ng-container>

           <!--Date Column-->
           <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">{{element.createdAt}}</td>
          </ng-container>

          <!--Device Type Column-->
          <ng-container matColumnDef="deviceType">
            <th mat-header-cell *matHeaderCellDef>Device Type-OS</th>
            <td mat-cell *matCellDef="let element">{{element.device_type}}-{{element.os_family}}</td>
          </ng-container>

          <!--Client Column-->
          <ng-container matColumnDef="client">
            <th mat-header-cell *matHeaderCellDef>Client Type-Name</th>
            <td mat-cell *matCellDef="let element">{{element.client_type}}-{{element.client_name}}</td>
          </ng-container>

          <!--IP Column-->
          <ng-container matColumnDef="ip">
            <th mat-header-cell *matHeaderCellDef>IP Address</th>
            <td mat-cell *matCellDef="let element">{{element.ipAddress}}</td>
          </ng-container>

          <!--Location Column-->
          <ng-container matColumnDef="location">
            <th mat-header-cell *matHeaderCellDef>Location</th>
            <td mat-cell *matCellDef="let element">{{element.city}}/{{element.region}}/{{element.country}}</td>
          </ng-container>

          <!--Coordinates Column-->
          <ng-container matColumnDef="coordinates">
            <th mat-header-cell *matHeaderCellDef>Latitude/Longitude</th>
            <td mat-cell *matCellDef="let element">{{element.latitude}}/{{element.longitude}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="userURLDataColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: userURLDataColumns;"></tr>
          </table>
        </div>
      </cdk-accordion-item>
    </cdk-accordion>
  </div>
</div>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">